
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Matrix Inverse &#8212; Applied Linear Algebra</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'inverse-matrices';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Problem Set 4: \(A=LU\) and Computation" href="lu-and-computation-problem-set.html" />
    <link rel="prev" title="Optional: Faster Matrix Multiplication" href="bonus-faster-matrix-multiplication.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Applied Linear Algebra - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Applied Linear Algebra - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Motivation</a></li>

<li class="toctree-l1"><a class="reference internal" href="vectors.html">Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors-problem-set.html">Problem Set 1: Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrices.html">Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrices-problem-set.html">Problem Set 2: Matrix Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear-systems-gaussian-elimination.html">Linear Systems and Gaussian Elimination</a></li>
<li class="toctree-l1"><a class="reference internal" href="gaussian-elimination-lu-problem-set.html">Problem Set 3: Gaussian Elimination and <span class="math notranslate nohighlight">\(A=LU\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="computation.html">Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonus-faster-matrix-multiplication.html">Optional: Faster Matrix Multiplication</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Matrix Inverse</a></li>
<li class="toctree-l1"><a class="reference internal" href="lu-and-computation-problem-set.html">Problem Set 4: <span class="math notranslate nohighlight">\(A=LU\)</span> and Computation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Finverse-matrices.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/inverse-matrices.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Matrix Inverse</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#don-t-use-the-inverse-to-solve-a-linear-system">Don’t Use the Inverse to Solve a Linear System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-inverse-theory">Matrix Inverse - Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-a-matrix-inverse">Calculating a Matrix Inverse</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-2-times2-shortcut">A <span class="math notranslate nohighlight">\(2\times2\)</span> Shortcut</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-matrix-inverse">
<h1>The Matrix Inverse<a class="headerlink" href="#the-matrix-inverse" title="Link to this heading">#</a></h1>
<p>In the previous section we introduced the idea of an ‘inverse’ elimination matrix; that is, a matrix <span class="math notranslate nohighlight">\(E_{ij}^{-1}\)</span> that would reverse whatever row operation <span class="math notranslate nohighlight">\(E_{ij}\)</span> performed on a matrix <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    E_{ij}^{-1}E_{ij}A = A.
\]</div>
<p>In fact, many matrices, not just elimination matrices, have inverses that reverse whatever action those matrices perform when they multiply other matrices or vectors.</p>
<div class="admonition-definition admonition">
<p class="admonition-title">Definition</p>
<p>Given a square matrix <span class="math notranslate nohighlight">\(A\)</span>, if there exists a matrix <span class="math notranslate nohighlight">\(A^{-1}\)</span> such that <span class="math notranslate nohighlight">\(A^{-1}A = AA^{-1} = I\)</span>, then we call <span class="math notranslate nohighlight">\(A^{-1}\)</span> the <em>inverse</em> of A, and we say that <span class="math notranslate nohighlight">\(A\)</span> is an invertible or nonsingular matrix. If no such matrix exists, we say that $A is noninvertible or singular.</p>
</div>
<section id="don-t-use-the-inverse-to-solve-a-linear-system">
<h2>Don’t Use the Inverse to Solve a Linear System<a class="headerlink" href="#don-t-use-the-inverse-to-solve-a-linear-system" title="Link to this heading">#</a></h2>
<p>Suppose that one had a linear system <span class="math notranslate nohighlight">\(A\mathbf{x} = \mathbf{b}\)</span>. If <span class="math notranslate nohighlight">\(A\)</span> is invertible, then we could in theory use <span class="math notranslate nohighlight">\(A^{-1}\)</span> to solve the system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align*}
        A\mathbf{x} &amp;= \mathbf{b} \\
        A^{-1}A\mathbf{x} &amp;= A^{-1}\mathbf{b} \\
        I\mathbf{x} &amp;= A^{-1}\mathbf{b} \\
        \mathbf{x} &amp;= A^{-1}\mathbf{b}.
    \end{align*}
\end{split}\]</div>
<p>This is theoretically correct and is fine for small examples done by hand, but it is almost never actually done in practice for reasons of efficiency and accuracy; for example, <a class="reference external" href="https://www.intel.com/content/www/us/en/docs/onemkl/developer-reference-c/2023-0/matrix-inversion-lapack-computational-routines.html">Intel’s LAPACK documentation</a> of the matrix inversion routine states the following:</p>
<blockquote>
<div><p>… do not attempt to solve a system of equations <span class="math notranslate nohighlight">\(A\mathbf{x} = \mathbf{b}\)</span> by first computing <span class="math notranslate nohighlight">\(A^{-1}\)</span> and then forming the matrix-vector product <span class="math notranslate nohighlight">\(\mathbf{x} = A^{-1}\mathbf{b}\)</span>. Call a solver routine instead (see Routines for Solving Systems of Linear Equations); this is more efficient and more accurate.</p>
</div></blockquote>
<p>They also note that:</p>
<blockquote>
<div><p>It is seldom necessary to compute an explicit inverse of a matrix.</p>
</div></blockquote>
<p>Indeed, while many of the applications that we are going to consider include inverse matrix calculations, we will almost always seek methods that avoid doing the inverse matrix calculations out in full for efficiency and numeric stability.</p>
</section>
<section id="matrix-inverse-theory">
<h2>Matrix Inverse - Theory<a class="headerlink" href="#matrix-inverse-theory" title="Link to this heading">#</a></h2>
<p>The matrix inverse does play an important part in the theory of linear algebra, so while we will aim to exclude it from actual calculations and algorithms, it is important to know its properties and pathologies.</p>
<div class="important admonition">
<p class="admonition-title">Not All Matrices Have Inverses</p>
<p>First, all matrices have inverses. Our definition already excludes non-square matrices; but many square matrices are singular also: if the columns of the matrix are linearly dependent, the matrix is singular.</p>
</div>
<p>With small examples, this can often be spotted right away:</p>
<p><strong>Example:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A = \begin{bmatrix}
            1 &amp; 2 \\
            2 &amp; 4
        \end{bmatrix}
\end{split}\]</div>
<p>is singular: the columns are scalar multiples of each other, and hence linearly dependent.</p>
<p>Equivalently, notice that if <span class="math notranslate nohighlight">\(A\)</span> is invertible, then the equation <span class="math notranslate nohighlight">\(A\mathbf{x} = \mathbf{0}\)</span> can only have one solution: <span class="math notranslate nohighlight">\(\mathbf{x} = \mathbf{0}\)</span>, because</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{align*}
        A\mathbf{x} &amp;= \mathbf{0} \\
        A^{-1}A\mathbf{x} &amp;= A^{-1}\mathbf{0} \\
        I\mathbf{x} &amp;= \mathbf{0} \\
        \mathbf{x} &amp;= \mathbf{0}.
    \end{align*}
\end{split}\]</div>
<p>But linearly dependence of a matrix’s columns means exactly that there <em>are</em> nonzero solutions to <span class="math notranslate nohighlight">\(A\mathbf{x} = \mathbf{0}\)</span>; for example, in the example above we can find</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{bmatrix}
        1 &amp; 2 \\
        2 &amp; 4
    \end{bmatrix}
    \begin{bmatrix}
        -2 \\
        1
    \end{bmatrix} = 
    \begin{bmatrix}
        0 \\
        0
    \end{bmatrix}
\end{split}\]</div>
<p>as one nonzero solution (there are infinitely many others).</p>
<div class="important admonition">
<p class="admonition-title">Inverses of Products Reverse Order</p>
<p>Inverses of products reverse order: <span class="math notranslate nohighlight">\((AB)^{-1} = B^{-1}A^{-1}\)</span>. We saw this earlier with elimination matrices and their inverses, but it is a general property of invertible matrices, which is illustrated in the following <span class="math notranslate nohighlight">\(2\times2\)</span> example.</p>
</div>
<p><strong>Example:</strong> Let</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \begin{bmatrix}
            1 &amp; -1 \\
            2 &amp; -1
        \end{bmatrix}\text{ and }
    B = \begin{bmatrix}
            2 &amp; 1 \\
            1 &amp; 1
        \end{bmatrix}.
\end{split}\]</div>
<p>Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A^{-1} = \begin{bmatrix}
                -1 &amp; 1 \\
                -2 &amp; 1
            \end{bmatrix}\text{ and }
    B^{-1} = \begin{bmatrix}
                1 &amp; -1 \\
                -1 &amp; 2
            \end{bmatrix}.
\end{split}\]</div>
<p>(Take a moment here to verify that <span class="math notranslate nohighlight">\(AA^{-1} = A^{-1}A = I = BB^{-1} = B^{-1}B\)</span>). Now,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    AB = \begin{bmatrix}
            1 &amp; -1 \\
            2 &amp; -1
        \end{bmatrix}
        \begin{bmatrix}
            2 &amp; 1 \\
            1 &amp; 1
        \end{bmatrix} = 
        \begin{bmatrix}
            1 &amp; 0 \\
            3 &amp; 1
        \end{bmatrix},
\end{split}\]</div>
<p>and you can further verify that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    (AB)^{-1} = \begin{bmatrix}
                    1 &amp; 0 \\
                    -3 &amp; 1
                \end{bmatrix} = 
                \begin{bmatrix}
                    1 &amp; -1 \\
                    -1 &amp; 2
                \end{bmatrix}
                \begin{bmatrix}
                    -1 &amp; 1 \\
                    -2 &amp; 1
                \end{bmatrix} = 
                B^{-1}A^{-1}.
\end{split}\]</div>
</section>
<section id="calculating-a-matrix-inverse">
<h2>Calculating a Matrix Inverse<a class="headerlink" href="#calculating-a-matrix-inverse" title="Link to this heading">#</a></h2>
<p>Although after this we will try to avoid ever calculating an inverse matrix for anything larger than <span class="math notranslate nohighlight">\(2\times2\)</span> in full, it is worthwhile to go through the computation once as it illustrates the important point that almost everything in linear algebra boils down to solving a linear system, and here we can exploit the <span class="math notranslate nohighlight">\(A=LU\)</span> factorization for efficiency on the way. For an <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span>, the inverse <span class="math notranslate nohighlight">\(A^{-1}\)</span> must have <span class="math notranslate nohighlight">\(k^{th}\)</span> column <span class="math notranslate nohighlight">\(A^{-1}_k\)</span> such that <span class="math notranslate nohighlight">\(AA^{-1}_k\)</span> is the <span class="math notranslate nohighlight">\(k^{th}\)</span> column of the <span class="math notranslate nohighlight">\(n\times n\)</span> identity matrix. So it is necessary to solve <span class="math notranslate nohighlight">\(n\)</span> linear systems of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    AA_k^{-1} = \begin{bmatrix}
                    0 \\
                    \vdots \\
                    0 \\
                    1 \\
                    0 \\
                    \vdots \\
                    0
                \end{bmatrix},
\end{split}\]</div>
<p>where the 1 in the vector above occurs in the <span class="math notranslate nohighlight">\(k^{th}\)</span> component. <span class="math notranslate nohighlight">\(A = LU\)</span> is commonly used to speed up computation when we need to solve <span class="math notranslate nohighlight">\(A\mathbf{x} = \mathbf{b}\)</span> for one <span class="math notranslate nohighlight">\(A\)</span> but many <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, and that is exactly the situation we find ourselves in here. Recall the approach:</p>
<ul class="simple">
<li><p>First obtain the factorization <span class="math notranslate nohighlight">\(A = LU\)</span> (this is usually the most expensive part). Then, for each <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> for which we need to solve <span class="math notranslate nohighlight">\(A\mathbf{x} = \mathbf{b}\)</span>,</p></li>
<li><p>Set <span class="math notranslate nohighlight">\(U\mathbf{x} = \mathbf{y};\)</span></p></li>
<li><p>Solve <span class="math notranslate nohighlight">\(L\mathbf{y} = \mathbf{b}\)</span> for <span class="math notranslate nohighlight">\(\mathbf{y};\)</span></p></li>
<li><p>Solve <span class="math notranslate nohighlight">\(U\mathbf{x} = \mathbf{y}\)</span> for <span class="math notranslate nohighlight">\(\mathbf{x}.\)</span></p></li>
</ul>
<p><strong>Example:</strong> Calculate the inverse of</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
    A = \begin{bmatrix}
            1 &amp; 2 &amp; -1 \\
            2 &amp; 1 &amp; 0 \\
            -1 &amp; 1 &amp; 2
        \end{bmatrix}.
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(A\)</span> has the following <span class="math notranslate nohighlight">\(LU\)</span> factorization (verify this!):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A = \begin{bmatrix}
            1 &amp; 0 &amp; 0 \\
            2 &amp; 1 &amp; 0 \\
            -1 &amp; -1 &amp; 1
        \end{bmatrix}
        \begin{bmatrix}
            1 &amp; 2 &amp; -1 \\
            0 &amp; -3 &amp; 2 \\
            0 &amp; 0 &amp; 3
        \end{bmatrix}.
\end{split}\]</div>
<p>Start with</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \mathbf{b} = \begin{bmatrix}
                    1 \\
                    0 \\
                    0
                \end{bmatrix}.
\end{split}\]</div>
<p>We need to solve <span class="math notranslate nohighlight">\(L\mathbf{y} = \mathbf{b}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
        \begin{bmatrix}
            1 &amp; 0 &amp; 0 \\
            2 &amp; 1 &amp; 0 \\
            -1 &amp; -1 &amp; 1
        \end{bmatrix}
        \mathbf{y} = \begin{bmatrix}
                        1 \\
                        0 \\
                        0
                    \end{bmatrix},
\end{split}\]</div>
<p>and thanks to the triangularity of <span class="math notranslate nohighlight">\(L\)</span> we can back-substitute to obtain <span class="math notranslate nohighlight">\(y_1 = 1\)</span>, <span class="math notranslate nohighlight">\(y_2 = -2\)</span>, and <span class="math notranslate nohighlight">\(y_3 = -1\)</span>. Now solve <span class="math notranslate nohighlight">\(U\mathbf{x} = \mathbf{y}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{bmatrix}
        1 &amp; 2 &amp; -1 \\
        0 &amp; -3 &amp; 2 \\
        0 &amp; 0 &amp; 3
    \end{bmatrix}\mathbf{x} = 
    \begin{bmatrix}
         1 \\
         -2 \\
         -1
    \end{bmatrix},
\end{split}\]</div>
<p>and again using back-substitution we can obtain <span class="math notranslate nohighlight">\(x_3 = -1/3\)</span>, <span class="math notranslate nohighlight">\(x_2=4/9\)</span>, and <span class="math notranslate nohighlight">\(x_1=-2/9\)</span>. So the first column of <span class="math notranslate nohighlight">\(A^{-1}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A_1^{-1} = \begin{bmatrix}
                    -2/9 \\
                    4/9 \\
                    -1/3
                \end{bmatrix}.
\end{split}\]</div>
<p>If we repeat this process two more times, using next <span class="math notranslate nohighlight">\(\mathbf{b} = [0\hspace{0.5em}1\hspace{0.5em}0]^T\)</span> and finally <span class="math notranslate nohighlight">\(\mathbf{b}=[0\hspace{0.5em}0\hspace{0.5em}1]^T\)</span>, then the three solutions obtained will be the columns of the inverse of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p><strong>Exercise:</strong> Complete the computation of the remaining columns of <span class="math notranslate nohighlight">\(A^{-1}\)</span> in the example above. Use the <span class="math notranslate nohighlight">\(LU\)</span> factorization provided. You should end up with</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A^{-1} = \begin{bmatrix}
                -2/9 &amp; 5/9 &amp; -1/9 \\
                4/9 &amp; -1/9 &amp; 2/9 \\
                -1/3 &amp; 1/3 &amp; 1/3
            \end{bmatrix}.
\end{split}\]</div>
<p>Verify that <span class="math notranslate nohighlight">\(AA^{-1} = A^{-1}A = I\)</span>.</p>
<div class="important admonition">
<p class="admonition-title"><span class="math notranslate nohighlight">\(A=LU\)</span> vs. Gaussian Elimination</p>
<p>Students often are first taught to calculate the inverse using Gaussian elimination on the augmented matrix <span class="math notranslate nohighlight">\([A | I]\)</span>. Briefly, if you augment <span class="math notranslate nohighlight">\(A\)</span> with the <span class="math notranslate nohighlight">\(n\times n\)</span> identity matrix and perform Gaussian elimination you can transform the augmented matrix to <span class="math notranslate nohighlight">\([I | A^{-1}]\)</span>, from which you can then just extract <span class="math notranslate nohighlight">\(A^{-1}\)</span>. This is another example of an approach which is fine for small examples done by hand but isn’t actually used in practice; <span class="math notranslate nohighlight">\(A=LU\)</span> is both more efficient and more numerically stable.</p>
</div>
</section>
<section id="a-2-times2-shortcut">
<h2>A <span class="math notranslate nohighlight">\(2\times2\)</span> Shortcut<a class="headerlink" href="#a-2-times2-shortcut" title="Link to this heading">#</a></h2>
<p>Many examples in this book use <span class="math notranslate nohighlight">\(2\times2\)</span> matrices, and it is helpful to know that there exists a convenient shortcut formula for finding the inverse of a <span class="math notranslate nohighlight">\(2\times2\)</span> matrix.</p>
<div class="admonition-times2-inverse-formula admonition">
<p class="admonition-title"><span class="math notranslate nohighlight">\(2\times2\)</span> Inverse Formula</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A=\begin{bmatrix}
        a &amp; b \\
        c &amp; d
    \end{bmatrix}.
\end{split}\]</div>
<p>Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A^{-1} = \frac{1}{ad-bc}\begin{bmatrix}
                                d &amp; -b \\
                                -c &amp; a
                            \end{bmatrix},
\end{split}\]</div>
<p>provided that <span class="math notranslate nohighlight">\(ad-bc \neq 0\)</span>; otherwise <span class="math notranslate nohighlight">\(A\)</span> is singular.</p>
</div>
<p><strong>Example:</strong> Refer back to the second example in this section, where we verified that <span class="math notranslate nohighlight">\((AB)^{-1} =  B^{-1}A^{-1}\)</span> for a specific <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>. Above I provided <span class="math notranslate nohighlight">\(A^{-1}\)</span> and <span class="math notranslate nohighlight">\(B^{-1}\)</span>, so here let’s simply confirm that the <span class="math notranslate nohighlight">\(2\times2\)</span> shortcut formula works:</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
    A = \begin{bmatrix}
            1 &amp; -1 \\
            2 &amp; -1
        \end{bmatrix},
\end{split}\]</div>
<p>so <span class="math notranslate nohighlight">\(a=1\)</span>, <span class="math notranslate nohighlight">\(b=-1\)</span>, <span class="math notranslate nohighlight">\(c=2\)</span>, and <span class="math notranslate nohighlight">\(d=-1\)</span>. According to the formula</p>
<div class="math notranslate nohighlight">
\[\begin{split}    A^{-1} = \frac{1}{ad-bc}\begin{bmatrix}
                                d &amp; -b \\
                                -c &amp; a
                            \end{bmatrix} = 
             \frac{1}{1\cdot(-1)-(-1)\cdot2}\begin{bmatrix}
                                                 -1 &amp; 1 \\
                                                 -2 &amp; -1
                                            \end{bmatrix} = 
            \begin{bmatrix}
                -1 &amp; 1 \\
                -2 &amp; -1
            \end{bmatrix},
\end{split}\]</div>
<p>where the scalar in front of the matrix has been omitted because it simply equals 1. This is same <span class="math notranslate nohighlight">\(A^{-1}\)</span> as above, which you have (or should have!) already confirmed satisfies <span class="math notranslate nohighlight">\(AA^{-1} = A^{-1}A = I\)</span>.</p>
<p><strong>Exercise:</strong> For the <span class="math notranslate nohighlight">\(B\)</span> in the second example, calculate <span class="math notranslate nohighlight">\(B^{-1}\)</span> using the shortcut formula and confirm that it matches what you already verified satisfied <span class="math notranslate nohighlight">\(BB^{-1} = B^{-1}B = I\)</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="bonus-faster-matrix-multiplication.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Optional: Faster Matrix Multiplication</p>
      </div>
    </a>
    <a class="right-next"
       href="lu-and-computation-problem-set.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Problem Set 4: <span class="math notranslate nohighlight">\(A=LU\)</span> and Computation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#don-t-use-the-inverse-to-solve-a-linear-system">Don’t Use the Inverse to Solve a Linear System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-inverse-theory">Matrix Inverse - Theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-a-matrix-inverse">Calculating a Matrix Inverse</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-2-times2-shortcut">A <span class="math notranslate nohighlight">\(2\times2\)</span> Shortcut</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremiah W. Johnson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="jwjohnson314" data-description="Support me on Buy me a coffee!" data-message="Thanks for reading! If you found this useful and want to support this book project, you can Buy Me a Coffee here. Your support helps keep this book free for my students." data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script> 
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>